@page "/"

@if (_state.Loaded)
{
    <p>Available Coal: @_state.Coal</p>

    <button class="btn btn-primary" @onclick="SaveAsync">Save</button>
    <button class="btn btn-primary" @onclick="AddFactory">Add Factory</button>

    <div class="scrollmenu">
        @foreach (var f in _state.Factories)
        {
            <Factory Self="@f"/>
        }
    </div>
}

@code {

    async Task SaveAsync()
    {
        await StateManager.SaveAsync();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await StateManager.LoadAsync();
            _state = StateManager.Get();
            _timer.Enabled = true;
            StateHasChanged();
        }
    }

}